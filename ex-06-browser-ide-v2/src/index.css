@tailwind base;
@tailwind components;
@tailwind utilities;

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  /* Prevent mobile zoom on input focus */
  -webkit-text-size-adjust: 100%;
  -ms-text-size-adjust: 100%;
}

#root {
  width: 100vw;
  height: 100vh;
  overflow: hidden;
}

.app {
  width: 100%;
  height: 100%;
}

/* Mobile-optimized layout styles */
.mobile-optimized-layout {
  --vh: 1vh;
  --keyboard-height: 0px;
  --effective-viewport-height: 100vh;
  --bottom-panel-height: 30vh;
  --safe-area-inset-top: env(safe-area-inset-top, 0);
  --safe-area-inset-bottom: env(safe-area-inset-bottom, 0);
  --safe-area-inset-left: env(safe-area-inset-left, 0);
  --safe-area-inset-right: env(safe-area-inset-right, 0);
}

.mobile-optimized-layout.is-mobile.keyboard-visible {
  /* Adjust for keyboard visibility */
  height: var(--effective-viewport-height);
}

/* Mobile input wrapper to prevent zoom */
.mobile-input-wrapper.prevent-zoom input,
.mobile-input-wrapper.prevent-zoom textarea,
.mobile-input-wrapper.prevent-zoom [contenteditable="true"] {
  font-size: 16px !important; /* Prevents zoom on iOS */
  -webkit-text-size-adjust: 100%;
  -ms-text-size-adjust: 100%;
}

/* Mobile bottom panel adjustments */
.mobile-bottom-panel.is-mobile.keyboard-visible {
  /* Position above keyboard */
  position: fixed;
  bottom: var(--keyboard-height);
  left: 0;
  right: 0;
  height: var(--bottom-panel-height);
  z-index: 30;
  border-top: 1px solid var(--border, #3e3e3e);
}

/* Mobile editor panel adjustments */
.mobile-editor-panel.is-mobile.keyboard-visible {
  /* Adjust for keyboard */
  height: var(--effective-viewport-height);
  padding-bottom: var(--bottom-panel-height);
  overflow: hidden;
}

/* Touch-friendly button styles */
.mobile-button {
  @apply touch-manipulation transition-colors duration-150 ease-in-out;
  min-height: 44px; /* iOS touch target size */
  min-width: 44px; /* iOS touch target size */
  @apply flex items-center justify-center gap-2;
  @apply outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-900;
}

/* Mobile-specific adjustments */
@media (max-width: 640px) {
  /* Reduce font sizes and spacing on mobile */
  .text-sm {
    font-size: 0.875rem;
    line-height: 1.25rem;
  }

  .text-xs {
    font-size: 0.75rem;
    line-height: 1rem;
  }

  /* Touch-friendly tap targets */
  .touch-target {
    min-height: 44px;
    min-width: 44px;
    @apply touch-manipulation;
  }

  /* Safe area support for iPhone X+ */
  .safe-area-top {
    padding-top: var(--safe-area-inset-top);
  }

  .safe-area-bottom {
    padding-bottom: var(--safe-area-inset-bottom);
  }

  .safe-area-left {
    padding-left: var(--safe-area-inset-left);
  }

  .safe-area-right {
    padding-right: var(--safe-area-inset-right);
  }

  .safe-area-all {
    padding: var(--safe-area-inset-top) var(--safe-area-inset-right) var(--safe-area-inset-bottom) var(--safe-area-inset-left);
  }

  /* Keyboard visible adjustments */
  .keyboard-visible .titlebar {
    @apply flex-shrink-0;
  }

  .keyboard-visible .bottom-panel-tabs {
    @apply flex-shrink-0 overflow-x-auto;
  }

  .keyboard-visible .bottom-panel-content {
    height: var(--bottom-panel-height);
    overflow: auto;
  }
}

/* Landscape mobile adjustments */
@media (max-width: 640px) and (orientation: landscape) {
  .keyboard-visible .bottom-panel-tabs {
    @apply py-1; /* Reduced padding in landscape */
  }

  .keyboard-visible .tab {
    @apply px-2 py-1 text-xs; /* More compact in landscape */
  }
}

/* High DPI displays */
@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
  /* Ensure sharp text on high DPI */
  body {
    -webkit-font-smoothing: subpixel-antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
}

/* Prevent scroll bounce on iOS */
.mobile-optimized-layout.is-mobile {
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;
}

/* Input focus styles for mobile */
@media (max-width: 640px) {
  input:focus,
  textarea:focus,
  [contenteditable="true"]:focus {
    @apply outline-none ring-2 ring-blue-500 ring-offset-2 ring-offset-gray-900;
    /* Prevent page zoom on focus */
    font-size: 16px !important;
  }

  /* Prevent zoom on select elements */
  select {
    font-size: 16px !important;
  }
}
